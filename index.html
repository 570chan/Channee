<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>neChannee!</title>

    <!-- Open Graph / Twitter -->
    <meta property="og:title" content="neChannene!" />
    <meta property="og:description" content="where i sleep at nightüåô" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://channee.vercel.app" />
    <meta property="og:image" content="https://s3.tebi.io/ely.bucket.s0.io.biti/downloaded-file.png.jpg" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="neChannee!" />
    <meta name="twitter:description" content="Join our cozy Discord ‚Äî where I take a nap and vibe with friends üåô" />
    <meta name="twitter:image" content="https://s3.tebi.io/ely.bucket.s0.io.biti/downloaded-file.png.jpg" />

    <link rel="icon" href="/favicon-32x32.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link href="https://fonts.googleapis.com/css2?family=Knewave&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet" />
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      :root { --bg: #f8fafc; --fg: #1e293b; --glass: rgba(255,255,255,0.25); --accent-1: #8be9fd; --accent-2: #7c4dff; }
      html,body{height:100%}
      body{
        margin:0; font-family: "Inter",system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue";
        background:var(--bg); color:var(--fg); overflow-x:hidden;
      }
      /* use the Knewave font for branded text */
      .knewave { font-family: "Knewave", system-ui, cursive; }

      .glass-card{
        background:transparent; border:2px solid #fff; border-radius:16px;
        box-shadow:0 0 32px rgba(255,255,255,0.25); transition:transform .3s,box-shadow .3s;
      }
      .profile-pic{ transition:transform .3s; box-shadow:0 2px 18px rgba(0,0,0,.13); }
      .profile-pic:hover{ transform:scale(1.05); }
      .link-card{ background:var(--glass); transition:transform .3s,box-shadow .3s; }
      .link-card:hover{ transform:translateY(-4px) scale(1.02); box-shadow:0 10px 25px -5px rgba(0,0,0,.14); }

      .fade-in{ opacity:0; animation:fadeIn 3s cubic-bezier(.42,0,.58,1) forwards; }
      @keyframes fadeIn{
        from{opacity:0; transform:translateY(28px)}
        to{opacity:1; transform:none}
      }

      .bg-video{
        position:fixed; inset:0; width:100vw; height:100vh; object-fit:cover; z-index:-2; pointer-events:none;
        transform:scale(1.02);
      }

      /* watercolor overlay (subtle) */
      .watercolor-overlay{
        position:fixed; inset:0; z-index:-1; pointer-events:none;
        mix-blend-mode: overlay; opacity:0.45;
        background-image:
          radial-gradient(ellipse at 10% 20%, rgba(199,122,255,0.28) 0%, transparent 20%),
          radial-gradient(ellipse at 80% 80%, rgba(139,233,253,0.22) 0%, transparent 18%),
          linear-gradient(90deg, rgba(255,227,138,0.06), rgba(255,210,241,0.03));
        filter: blur(18px) saturate(1.05);
        animation: watercolorShift 18s ease-in-out infinite;
      }
      @keyframes watercolorShift{
        0%{ transform: translate3d(0,0,0) scale(1) }
        50%{ transform: translate3d(-6%,4%,0) scale(1.02) }
        100%{ transform: translate3d(0,0,0) scale(1) }
      }

      /* subtle grain / paper texture using pseudo-element on overlay */
      .watercolor-overlay::after{
        content:""; position:absolute; inset:0; background-image: url('data:image/svg+xml;utf8,\
          <svg xmlns="http://www.w3.org/2000/svg" width="600" height="400">\
            <filter id="n">\
              <feTurbulence baseFrequency="0.9" numOctaves="2" stitchTiles="stitch"/>\
              <feColorMatrix type="saturate" values="0"/>\
            </filter>\
            <rect width="100%" height="100%" filter="url(%23n)" opacity="0.06" fill="black"/>\
          </svg>'); mix-blend-mode: multiply; opacity:0.6; pointer-events:none;
        transform: scale(1.2);
      }

      /* Timer */
      .timer-hidden{ display:none!important; }
      #timer-container{ width:100%; box-sizing:border-box; display:flex; flex-direction:column; align-items:center; justify-content:center; padding:2rem 1rem; }
      #timer-display{ font-variant-numeric:tabular-nums; letter-spacing:1px; text-align:center; color:#F0FFF0; font-size:3rem; }
      .timer-controls{ display:flex; gap:12px; margin-top:16px; }
      .timer-controls button{ padding:10px 14px; border-radius:10px; border:1px solid rgba(255,255,255,.6); background:rgba(255,255,255,.06); color:inherit; cursor:pointer; }

      .timer-transition{ transition:all .45s ease; will-change:opacity,transform,filter; }
      .timer-show{ opacity:1; transform:scale(1); filter:blur(0); }
      .timer-hide{ opacity:0; transform:scale(.96); filter:blur(0); } /* no blur per request */

      .hint-arrow{ position:absolute; top:50%; transform:translateY(-50%); font-size:2.2rem; color:rgba(255,255,255,.85); opacity:0; pointer-events:none; transition:opacity .5s; z-index:50; }
      .hint-arrow.show{ opacity:1; }
      #arrow-left{ left:12% }
      #arrow-right{ right:12% }
      @media(max-width:640px){ #arrow-left{left:4%} #arrow-right{right:4%} }

      .link-card[href*="#"]{
        background-image:url('https://s3.tebi.io/ely.bucket.s0.io.biti/anime-girl-and-cat-watching-rain-thumb-728x410.jpg');
        background-size:cover; background-position:center; color:#fff;
      }

      /* START overlay: covers whole screen. No blur or dimming per request. */
      #start-overlay{
        position:fixed; inset:0; display:flex; align-items:center; justify-content:center; z-index:9998;
        background: transparent; /* explicit: no dim/blur */
        cursor: pointer;
      }
      /* CTA styles: remove black box, use neChannee font (knewave), and add attractive text effects */
      #start-overlay .cta{
        background: transparent; /* remove dark box */
        color: transparent; /* use gradient fill via background-clip */
        padding: 8px 20px;
        border-radius: 12px;
        font-size:1.25rem; font-weight:700;
        box-shadow: none;
        -webkit-background-clip: text;
        background-clip: text;
        background-image: linear-gradient(90deg, var(--accent-1) 0%, #9be7ff 25%, #caa2ff 60%, var(--accent-2) 100%);
        text-shadow: 0 6px 28px rgba(124,77,255,0.15), 0 2px 6px rgba(0,0,0,0.25);
        transform: translateY(0);
        transition: transform 220ms cubic-bezier(.2,.9,.3,1), text-shadow 220ms ease, filter 220ms ease;
        font-family: "Knewave", system-ui, cursive; /* ensure brand font is used */
        letter-spacing: .6px;
        outline: none; /* remove focus ring appearance (we still keep keyboard activation) */
        display:inline-block;
        white-space:nowrap;
      }
      /* subtle hover / press effect for CTA */
      #start-overlay .cta:hover{ transform: translateY(-4px) scale(1.02); filter:brightness(1.02); text-shadow: 0 10px 40px rgba(124,77,255,0.18), 0 3px 8px rgba(0,0,0,0.28); }
      #start-overlay .cta:active{ transform: translateY(-2px) scale(0.995); }

      /* ensure focus still visible for accessibility ‚Äî use an outline that's not a black box */
      #start-overlay .cta:focus{ box-shadow: 0 0 0 4px rgba(124,77,255,0.12), 0 6px 20px rgba(0,0,0,0.12); border-radius:12px; }

      /* hide main content initially */
      .initial-hidden{ display:none; }
      
      /* Branded title effect for 'Channee' */
      .brand-title {
        background: linear-gradient(90deg, #ffe38a 0%, #ffd1f0 30%, #bde6ff 60%, #c9b3ff 100%);
        -webkit-background-clip: text;
        background-clip: text;
        color: transparent;
        font-size: 2.25rem;
        text-shadow: 0 10px 30px rgba(124,77,255,0.12), 0 2px 8px rgba(0,0,0,0.12);
      }
      /* Optional subtle animation on load for brand */
      .brand-animate { animation: floatText 2.4s ease-in-out infinite; transform-origin:center; }
      @keyframes floatText {
        0%{ transform: translateY(0) }
        50%{ transform: translateY(-3px) }
        100%{ transform: translateY(0) }
      }

      /* Typewriter caret animation for accessibility fallback */
      .typewriter-caret{
        display:inline-block;
        width:2px;
        height:1.1em;
        background: linear-gradient(180deg, #fff, #ddd);
        margin-left:6px;
        vertical-align:middle;
        animation: blink 1s steps(2,start) infinite;
      }
      @keyframes blink{ 50%{ opacity:0 } }
    </style>
  </head>

  <body class="min-h-screen flex items-center justify-center px-4 py-8 relative">
    <!-- Background Video -->
    <video id="bg-video" class="bg-video" autoplay loop muted playsinline>
      <source src="https://s3.tebi.io/ely.bucket.s0.io.biti/TikTok%20-%20Make%20Your%20Day.mp4" type="video/mp4" />
    </video>

    <!-- Watercolor overlay -->
    <div class="watercolor-overlay" aria-hidden="true"></div>

    <!-- Audio (no forced autoplay; play initiated on user gesture when overlay clicked) -->
    <audio id="bg-music" preload="auto" playsinline loop>
      <!-- FIXED: proper audio MIME type and valid source element -->
      <source src="https://s3.tebi.io/ely.bucket.s0.io.biti/%C4%90%C6%B0%E1%BB%9Dng%20T%C3%B4i%20Ch%E1%BB%9F%20Em%20V%E1%BB%81%20_%20buitruonglinh%20%20Lyrics%20Video%20%20-%20buitruonglinh.mp3" type="audio/mpeg">
      <!-- Fallback text -->
      Your browser does not support the audio element.
    </audio>

    <!-- START overlay that captures the first click/tap anywhere -->
    <div id="start-overlay" role="button" aria-label="Click to enter" tabindex="0">
      <div class="cta" id="cta-text" aria-hidden="false"></div><span class="typewriter-caret" id="cta-caret" aria-hidden="true"></span>
    </div>

    <!-- Main content hidden initially; will fade in after overlay click -->
    <div id="main-content" class="max-w-md w-full mx-auto fade-in initial-hidden" aria-hidden="true">
      <!-- Profile card -->
      <div class="glass-card p-8 mb-8 text-center">
        <div class="flex justify-center mb-6">
          <img src="https://s3.tebi.io/ely.bucket.s0.io.biti/282097915f9d08ecbe8b367d00ac7a22.jpg"
               alt="Profile" class="profile-pic w-24 h-24 rounded-full object-cover" />
        </div>

        <!-- Brand title uses knewave + gradient/shadow effect -->
        <h1 class="brand-title knewave font-bold mb-1 brand-animate">Channee</h1>
        <p class="text-gray-600 mb-6">I don't even remember who I am...</p>

        <!-- Clock -->
        <div class="clock-container mb-8">
          <div id="time" class="text-5xl font-light text-[#F0FFF0]"></div>
          <div id="date" class="text-sm text-gray-100 mt-2"></div>
        </div>

        <!-- Social -->
        <div class="flex justify-center space-x-4 text-white">
          <a href="https://github.com/570chan" target="_blank" rel="noopener" aria-label="GitHub"><i class="fab fa-github fa-lg"></i></a>
          <a href="https://www.facebook.com/profile.php?id=61581606718917" target="_blank" rel="noopener" aria-label="Facebook"><i class="fab fa-facebook fa-lg"></i></a>
          <a href="https://linkedin.com/in/your-profile" target="_blank" rel="noopener" aria-label="LinkedIn"><i class="fab fa-linkedin fa-lg"></i></a>
        </div>

        <!-- Timer container (hidden by default) -->
        <div id="timer-container" class="timer-hidden mt-6">
          <p class="text-sm text-gray-200 mb-2 opacity-80">‚è≥ Countdown Timer ‚Äî 30 ph√∫t th∆∞ gi√£n</p>
          <div id="timer-display">30:00</div>
          <div class="timer-controls">
            <button id="start-pause-btn" title="Start / Pause" class="">
              <i class="fa fa-play"></i>
            </button>
            <button id="reset-btn" title="Reset">
              <i class="fa fa-rotate-right"></i>
            </button>
          </div>
        </div>

        <div id="arrow-left" class="hint-arrow">‚Üê</div>
        <div id="arrow-right" class="hint-arrow">‚Üí</div>
      </div>

      <!-- Discord / Link box -->
      <div class="space-y-4">
        <a href="#" class="block link-card glass-card p-2 rounded-lg">
          <div class="flex items-center">
            <div class="mr-4 flex items-center"></div>
            <div>
              <h3 class="font-medium text-gray-800">Unknown</h3>
              <p class="text-sm text-gray-500">where i take a nap</p>
            </div>
          </div>
          <ul class="mt-3 space-y-1 text-sm text-gray-700">
            <li>‚Ä¢ <b>air</b> _.570chan</li>
          </ul>
        </a>
      </div>
    </div>

    <script src="https://unpkg.com/feather-icons"></script>
    <script>
  (function () {
    // little helpers
    const $ = (s, ctx = document) => ctx.querySelector(s);
    const $$ = (s, ctx = document) => Array.from((ctx || document).querySelectorAll(s));

    // Clock
    function updateClock() {
      const now = new Date();
      const optionsTime = { timeZone: 'Asia/Ho_Chi_Minh', hour12: false, hour: '2-digit', minute: '2-digit' };
      const timeStr = now.toLocaleTimeString('en-US', optionsTime);
      const [hours, minutes] = timeStr.split(':');
      const optionsDate = { timeZone: 'Asia/Ho_Chi_Minh', weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
      const dateStr = now.toLocaleDateString('en-US', optionsDate);
      $('#time').textContent = `${hours}:${minutes}`;
      $('#date').textContent = dateStr;
    }
    updateClock();
    setInterval(updateClock, 1000);

    // Icons
    try { feather.replace(); } catch(e){}

    // Helper: safe parse initial minutes from container attribute (fallback to 30)
    function getInitialSeconds(timerContainer) {
      if (!timerContainer) return 30 * 60;
      const attr = timerContainer.getAttribute('data-initial-minutes');
      const n = Number(attr);
      if (!attr || Number.isNaN(n) || !isFinite(n)) return 30 * 60;
      return Math.max(1, Math.floor(n)) * 60;
    }

    /* Timer module + audio + Media Session */
    (function () {
      const card = document.querySelector('.glass-card img.profile-pic')?.closest('.glass-card') || document.querySelector('.glass-card');
      if (!card) return;

      const timerContainer = document.getElementById('timer-container');
      const timerDisplay = document.getElementById('timer-display');
      const startPauseBtn = document.getElementById('start-pause-btn');
      const resetBtn = document.getElementById('reset-btn');
      const children = Array.from(card.children).filter(c => c !== timerContainer);

      // INITIAL duration read from DOM attribute for easy changes
      const INITIAL = getInitialSeconds(timerContainer);
      let remaining = INITIAL, intervalId = null, running = false, showing = false;

      const audio = document.getElementById('bg-music');
      if (audio) { audio.loop = true; audio.volume = 0.6; }

      function fmt(sec){
        const m = String(Math.floor(sec/60)).padStart(2,'0');
        const s = String(Math.floor(sec%60)).padStart(2,'0');
        return `${m}:${s}`;
      }
      function render(){ timerDisplay.textContent = fmt(remaining); }

      function ensureNotificationPermission(){
        if (!('Notification' in window)) return Promise.resolve('unsupported');
        if (Notification.permission === 'granted') return Promise.resolve('granted');
        if (Notification.permission === 'denied') return Promise.resolve('denied');
        return Notification.requestPermission();
      }

      // Show a detailed "Now playing" notification with metadata when playback starts.
      function showNowPlayingNotification(metadata = {}) {
        ensureNotificationPermission().then(p => {
          if (p !== 'granted') return;
          try {
            const title = metadata.title ? `Now playing ‚Äî ${metadata.title}` : 'Now playing';
            const bodyParts = [];
            if (metadata.artist) bodyParts.push(`Artist: ${metadata.artist}`);
            if (metadata.album) bodyParts.push(`Album: ${metadata.album}`);
            if (metadata.site) bodyParts.push(`Source: ${metadata.site}`);
            const body = bodyParts.join('\n') || 'Playing audio from this site.';
            const opt = {
              body,
              icon: metadata.icon || 'https://s3.tebi.io/ely.bucket.s0.io.biti/282097915f9d08ecbe8b367d00ac7a22.jpg',
              badge: metadata.badge || 'https://s3.tebi.io/ely.bucket.s0.io.biti/downloaded-file.png.jpg',
              tag: 'nechannee-now-playing',
              renotify: false,
              data: {
                url: metadata.site || window.location.origin,
                title: metadata.title || '',
                artist: metadata.artist || ''
              }
            };
            new Notification(title, opt);
          } catch (err) {
            console.warn('Notification failed:', err);
          }
        });
      }

      function notifyEnd(){
        ensureNotificationPermission().then(p => {
          if (p === 'granted') {
            try {
              new Notification('‚è∞ H·∫øt gi·ªù r·ªìi!', {
                body: 'ƒê·∫øm ng∆∞·ª£c ƒë√£ k·∫øt th√∫c.',
                icon: 'https://cdn-icons-png.flaticon.com/512/992/992700.png',
                tag: 'nechannee-timer-end'
              });
            }
            catch(e){ alert('ƒê·∫øm ng∆∞·ª£c k·∫øt th√∫c!'); }
          } else {
            alert('ƒê·∫øm ng∆∞·ª£c k·∫øt th√∫c!');
          }
        });
      }

      // Media Session setup (so Android/Chrome notification shows title/artist/artwork and playback controls)
      function setupMediaSession() {
        if (!('mediaSession' in navigator) || !audio) return;
        try {
          navigator.mediaSession.metadata = new MediaMetadata({
            title: 'ƒê∆∞·ªùng T√¥i Ch·ªù Em V·ªÅ',
            artist: 'buitruonglinh',
            album: 'Single',
            artwork: [
              { src: 'https://s3.tebi.io/ely.bucket.s0.io.biti/downloaded-file.png.jpg',   sizes: '96x96',   type: 'image/png' },
              { src: 'https://s3.tebi.io/ely.bucket.s0.io.biti/282097915f9d08ecbe8b367d00ac7a22.jpg', sizes: '300x300', type: 'image/jpeg' },
              { src: 'https://s3.tebi.io/ely.bucket.s0.io.biti/282097915f9d08ecbe8b367d00ac7a22.jpg', sizes: '512x512', type: 'image/jpeg' }
            ]
          });

          // Keep playbackState in sync
          navigator.mediaSession.playbackState = audio && !audio.paused ? 'playing' : 'paused';

          navigator.mediaSession.setActionHandler('play', async () => {
            try { await audio.play(); navigator.mediaSession.playbackState = 'playing'; } catch(e){}
          });
          navigator.mediaSession.setActionHandler('pause', () => {
            try { audio.pause(); navigator.mediaSession.playbackState = 'paused'; } catch(e){}
          });
          // Optional handlers (no-op unless you implement playlist)
          try { navigator.mediaSession.setActionHandler('previoustrack', () => { /* noop */ }); } catch(e){}
          try { navigator.mediaSession.setActionHandler('nexttrack', () => { /* noop */ }); } catch(e){}

          // Update state on audio events
          audio.addEventListener('play', () => { try { navigator.mediaSession.playbackState = 'playing'; } catch(e){} });
          audio.addEventListener('pause', () => { try { navigator.mediaSession.playbackState = 'paused'; } catch(e){} });
          audio.addEventListener('ended', () => { try { navigator.mediaSession.playbackState = 'none'; } catch(e){} });
        } catch (err) {
          console.warn('Media Session setup failed', err);
        }
      }

      function start(){
        if (running) return;
        running = true;
        startPauseBtn.innerHTML = '<i class="fa fa-pause"></i>';
        if (audio) {
          const p = audio.play();
          if (p && typeof p.then === 'function') {
            p.then(() => {
              setupMediaSession();
              // show now playing notification with rich metadata (also handled by media session UI)
              showNowPlayingNotification({
                title: 'ƒê∆∞·ªùng T√¥i Ch·ªù Em V·ªÅ',
                artist: 'buitruonglinh',
                album: 'Single',
                site: 'channee.vercel.app',
                icon: 'https://s3.tebi.io/ely.bucket.s0.io.biti/282097915f9d08ecbe8b367d00ac7a22.jpg',
                badge: 'https://s3.tebi.io/ely.bucket.s0.io.biti/downloaded-file.png.jpg'
              });
            }).catch(err => {
              console.warn('Audio play was blocked or failed:', err);
            });
          } else {
            // fallback for browsers without Promise-returning play()
            setupMediaSession();
            showNowPlayingNotification({
              title: 'ƒê∆∞·ªùng T√¥i Ch·ªù Em V·ªÅ',
              artist: 'buitruonglinh',
              album: 'Single',
              site: 'channee.vercel.app',
              icon: 'https://s3.tebi.io/ely.bucket.s0.io.biti/282097915f9d08ecbe8b367d00ac7a22.jpg',
              badge: 'https://s3.tebi.io/ely.bucket.s0.io.biti/downloaded-file.png.jpg'
            });
          }
        }
        intervalId = setInterval(() => {
          if (remaining > 0) { remaining--; render(); }
          else {
            clearInterval(intervalId); intervalId = null; running = false;
            startPauseBtn.innerHTML = '<i class="fa fa-play"></i>';
            if (audio) { try { audio.pause(); audio.currentTime = 0; } catch(e){} }
            notifyEnd();
          }
        }, 1000);
      }

      function pause(){
        if (!running) return;
        running = false;
        clearInterval(intervalId); intervalId = null;
        startPauseBtn.innerHTML = '<i class="fa fa-play"></i>';
        if (audio) try { audio.pause(); } catch(e){}
      }

      function reset(){
        pause();
        remaining = INITIAL;
        render();
      }

      function showTimer(){
        if (showing) return;
        children.forEach(c => (c.style.display = 'none'));
        timerContainer.classList.remove('timer-hidden');
        timerContainer.classList.add('timer-transition','timer-hide');
        setTimeout(() => timerContainer.classList.replace('timer-hide','timer-show'), 10);
        showing = true; render();
      }

      function hideTimer(){
        if (!showing) return;
        timerContainer.classList.replace('timer-show','timer-hide');
        setTimeout(() => {
          timerContainer.classList.add('timer-hidden');
          children.forEach(c => (c.style.display = ''));
        }, 500);
        showing = false;
      }

      function toggleTimerView(){ showing ? hideTimer() : showTimer(); }

      startPauseBtn.addEventListener('click', e => { e.stopPropagation(); running ? pause() : start(); });
      resetBtn.addEventListener('click', e => { e.stopPropagation(); reset(); });

      let tsX = null, tsY = null;
      const TH = 40;
      function handleSwipe(dx, dy){ if (Math.abs(dx) > Math.abs(dy) && Math.abs(dx) > TH) toggleTimerView(); }

      [card, timerContainer].forEach(el => {
        el.addEventListener('touchstart', e => { const t = e.touches[0]; tsX = t.clientX; tsY = t.clientY; }, { passive:true });
        el.addEventListener('touchend', e => {
          if (tsX === null) return;
          const t = e.changedTouches[0];
          handleSwipe(t.clientX - tsX, t.clientY - tsY);
          tsX = tsY = null;
        }, { passive:true });
      });

      let mDown = false, mStartX = 0;
      [card, timerContainer].forEach(el => {
        el.addEventListener('mousedown', e => { mDown = true; mStartX = e.clientX; });
      });
      window.addEventListener('mouseup', e => {
        if (!mDown) return; mDown = false;
        const dx = e.clientX - mStartX;
        if (Math.abs(dx) > TH) toggleTimerView();
      });

      card.addEventListener('dblclick', toggleTimerView);
      timerContainer.addEventListener('dblclick', toggleTimerView);

      window.addEventListener('beforeunload', () => { intervalId && clearInterval(intervalId); });

      // initial render
      render();

      // expose control API for debugging
      window.__neChanneeTimer = { start, pause, reset, show: showTimer, hide: hideTimer, getRemaining: () => remaining, getInitial: () => INITIAL };
    })();

    /* Hint arrows (show a few times) */
    (function () {
      const left = document.getElementById('arrow-left'), right = document.getElementById('arrow-right');
      if (!left || !right) return;
      let count = 0, max = 5;
      const id = setInterval(() => {
        if (count >= max) { left.remove(); right.remove(); clearInterval(id); return; }
        count++;
        left.classList.add('show'); right.classList.add('show');
        setTimeout(() => { left.classList.remove('show'); right.classList.remove('show'); }, 2000);
      }, 5000);
    })();

    /* Typewriter text + Start overlay behavior */
    (function () {
      const overlay = document.getElementById('start-overlay');
      const main = document.getElementById('main-content');
      const audio = document.getElementById('bg-music');
      const cta = document.getElementById('cta-text');
      const caret = document.getElementById('cta-caret');

      if (!overlay || !main || !cta) return;

      const CTA_TEXT = 'Click here';
      let typingInterval = null;
      let typed = '';

      function startTypewriter(){
        if (typed === CTA_TEXT) return;
        typed = '';
        cta.textContent = '';
        caret.style.display = 'inline-block';
        let i = 0;
        typingInterval = setInterval(() => {
          typed += CTA_TEXT[i];
          cta.textContent = typed;
          i++;
          if (i >= CTA_TEXT.length) {
            clearInterval(typingInterval);
            typingInterval = null;
            setTimeout(() => { caret.style.opacity = '0'; setTimeout(()=> caret.style.display='none', 350); }, 900);
          }
        }, 120);
      }

      startTypewriter();

      const ACCEPT_KEYS = new Set(['Enter', ' ', 'Spacebar', 'Space']);

      function activate(e) {
        if (e && e.type === 'keydown' && !ACCEPT_KEYS.has(e.key)) return;
        e && e.preventDefault && e.preventDefault();

        main.classList.remove('initial-hidden');
        main.setAttribute('aria-hidden','false');

        overlay.remove();

        if (audio) {
          try {
            audio.muted = false;
            audio.currentTime = 0;
            const p = audio.play();
            if (p && typeof p.then === 'function') {
              p.then(() => {
                // fire a notification if permissions already granted
                try {
                  if ('Notification' in window && Notification.permission === 'granted') {
                    new Notification('Now playing ‚Äî ƒê∆∞·ªùng T√¥i Ch·ªù Em V·ªÅ', {
                      body: 'Artist: buitruonglinh\nSource: channee.vercel.app',
                      icon: 'https://s3.tebi.io/ely.bucket.s0.io.biti/282097915f9d08ecbe8b367d00ac7a22.jpg',
                      badge: 'https://s3.tebi.io/ely.bucket.s0.io.biti/downloaded-file.png.jpg',
                      tag: 'nechannee-now-playing'
                    });
                  }
                } catch (err) { /* ignore */ }
              }).catch(err => {
                console.warn('Audio play was blocked or failed:', err);
              });
            }
          } catch (err) {
            console.warn('Audio play exception:', err);
          }
        }

        try {
          cta.style.transition = 'transform .45s ease, opacity .45s ease';
          cta.style.transform = 'translateY(-10px) scale(.98)';
          cta.style.opacity = '0';
          if (caret) { caret.style.transition = 'opacity .45s ease, transform .45s ease'; caret.style.opacity = '0'; }
        } catch(e){}

        try { feather.replace(); } catch (e) {}
        window.removeEventListener('click', activate);
        window.removeEventListener('keydown', activate);
        if (typingInterval) { clearInterval(typingInterval); typingInterval = null; }
        if (e && e.stopPropagation) e.stopPropagation();
      }

      window.addEventListener('click', activate, { once: true, capture: true });
      window.addEventListener('keydown', activate, { once: true, capture: true });
      try { overlay.focus(); } catch (e) {}

      overlay.addEventListener('focus', startTypewriter);
      overlay.addEventListener('mouseover', startTypewriter);
    })();

    /* Request notification permission politely (non-blocking) */
    if ('Notification' in window && Notification.permission === 'default') {
      try { Notification.requestPermission().then(p => console.log('Notification permission:', p)); } catch(e){}
    }
  })();
    </script>
  </body>
</html>
